<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Law School Registration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen py-8 px-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-amber-600 rounded-full mb-4">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"/>
                </svg>
            </div>
            <h1 class="text-3xl font-bold text-white mb-2">Postgraduate Law School</h1>
            <p class="text-amber-100">Register Your Account</p>
        </div>

        <!-- Registration Type Toggle -->
        <div class="bg-white rounded-t-2xl p-2 flex space-x-2">
            <button onclick="showStudentForm()" id="studentTab" class="flex-1 py-3 px-6 rounded-lg font-semibold transition-all bg-amber-600 text-white">
                Student Registration
            </button>
            <button onclick="showLecturerForm()" id="lecturerTab" class="flex-1 py-3 px-6 rounded-lg font-semibold transition-all bg-gray-100 text-gray-600 hover:bg-gray-200">
                Lecturer Registration
            </button>
        </div>

        <!-- Student Registration Form -->
        <div id="studentForm" class="bg-white rounded-b-2xl shadow-2xl p-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Student Registration</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Full Name -->
                <div class="md:col-span-2">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Full Name *</label>
                    <input type="text" id="studentFullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Enter your full name" required>
                </div>

                <!-- Date of Birth -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Date of Birth *</label>
                    <input type="date" id="studentDob" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" required>
                </div>

                <!-- Nationality -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Nationality *</label>
                    <input type="text" id="studentNationality" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., Nigerian" required>
                </div>

                <!-- Phone Number -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Phone Number *</label>
                    <input type="tel" id="studentPhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., 08012345678" required>
                </div>

                <!-- Email -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Email Address *</label>
                    <input type="email" id="studentEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="your.email@example.com" required>
                </div>

                <!-- Bachelor Degree -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Bachelor Degree *</label>
                    <input type="text" id="studentDegree" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., LLB" required>
                </div>

                <!-- University Attended -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">University Attended *</label>
                    <input type="text" id="studentUniversity" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., University of Lagos" required>
                </div>

                <!-- Year Graduated -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Year Graduated *</label>
                    <input type="number" id="studentYearGraduated" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., 2020" min="1990" max="2025" required>
                </div>

                <!-- Program Selection -->
                <div class="md:col-span-2">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Select Program *</label>
                    <select id="studentProgram" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white" required>
                        <option value="">-- Choose Your Program --</option>
                        <option value="1">LLM in International Law</option>
                        <option value="2">LLM in Commercial Law</option>
                        <option value="3">LLM in Criminal Law</option>
                        <option value="4">LLM in Human Rights Law</option>
                    </select>
                </div>

                <!-- Password -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Password *</label>
                    <input type="password" id="studentPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Create a password" required>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Confirm Password *</label>
                    <input type="password" id="studentConfirmPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Confirm your password" required>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="mt-8">
                <button onclick="registerStudent()" class="w-full bg-gradient-to-r from-amber-600 to-amber-700 text-white py-3 rounded-lg font-semibold hover:from-amber-700 hover:to-amber-800 transition-all duration-200 shadow-lg">
                    Register as Student
                </button>
            </div>

            <!-- Login Link -->
            <div class="mt-6 text-center">
                <p class="text-gray-600 text-sm">
                    Already have an account? 
                    <a href="login.html" class="text-amber-600 hover:text-amber-700 font-semibold">Login here</a>
                </p>
            </div>
        </div>

        <!-- Lecturer Registration Form -->
        <div id="lecturerForm" class="bg-white rounded-b-2xl shadow-2xl p-8 hidden">
            <h2 class="text-2xl font-bold text-gray-900 mb-6">Lecturer Registration</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Full Name -->
                <div class="md:col-span-2">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Full Name *</label>
                    <input type="text" id="lecturerFullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Enter your full name" required>
                </div>

                <!-- Date of Birth -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Date of Birth *</label>
                    <input type="date" id="lecturerDob" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" required>
                </div>

                <!-- Gender -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Gender *</label>
                    <select id="lecturerGender" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white" required>
                        <option value="">-- Select Gender --</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <!-- Phone Number -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Phone Number *</label>
                    <input type="tel" id="lecturerPhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="e.g., 09012345678" required>
                </div>

                <!-- Email -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Email Address *</label>
                    <input type="email" id="lecturerEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="your.email@example.com" required>
                </div>

                <!-- Academic Rank -->
                <div class="md:col-span-2">
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Academic Rank *</label>
                    <select id="lecturerRank" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 bg-white" required>
                        <option value="">-- Select Academic Rank --</option>
                        <option value="Lecturer">Lecturer</option>
                        <option value="Senior Lecturer">Senior Lecturer</option>
                        <option value="Associate Professor">Associate Professor</option>
                        <option value="Professor">Professor</option>
                    </select>
                </div>

                <!-- Password -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Password *</label>
                    <input type="password" id="lecturerPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Create a password" required>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label class="block text-gray-700 text-sm font-semibold mb-2">Confirm Password *</label>
                    <input type="password" id="lecturerConfirmPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500" placeholder="Confirm your password" required>
                </div>
            </div>

            <!-- Info Note -->
            <div class="mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4">
                <p class="text-sm text-blue-800">
                    <strong>Note:</strong> Course assignments and teaching schedules will be assigned by the administration after your registration is approved.
                </p>
            </div>

            <!-- Submit Button -->
            <div class="mt-6">
                <button onclick="registerLecturer()" class="w-full bg-gradient-to-r from-amber-600 to-amber-700 text-white py-3 rounded-lg font-semibold hover:from-amber-700 hover:to-amber-800 transition-all duration-200 shadow-lg">
                    Register as Lecturer
                </button>
            </div>

            <!-- Login Link -->
            <div class="mt-6 text-center">
                <p class="text-gray-600 text-sm">
                    Already have an account? 
                    <a href="#" class="text-amber-600 hover:text-amber-700 font-semibold">Login here</a>
                </p>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 mb-2">Registration Successful!</h3>
                    <p id="successMessage" class="text-gray-600 mb-6"></p>
                    <button onclick="closeModal()" class="w-full bg-amber-600 text-white py-3 rounded-lg font-semibold hover:bg-amber-700 transition-all">
                        Go to Login
                    </button>
                </div>
            </div>
        </div>
    </div>
        <script src="../../backend/db_connection/supabase-config.js"></script>


    <script>
        // Toggle between Student and Lecturer forms
        function showStudentForm() {
            document.getElementById('studentForm').classList.remove('hidden');
            document.getElementById('lecturerForm').classList.add('hidden');
            document.getElementById('studentTab').classList.add('bg-amber-600', 'text-white');
            document.getElementById('studentTab').classList.remove('bg-gray-100', 'text-gray-600');
            document.getElementById('lecturerTab').classList.remove('bg-amber-600', 'text-white');
            document.getElementById('lecturerTab').classList.add('bg-gray-100', 'text-gray-600');
        }

        function showLecturerForm() {
            document.getElementById('studentForm').classList.add('hidden');
            document.getElementById('lecturerForm').classList.remove('hidden');
            document.getElementById('lecturerTab').classList.add('bg-amber-600', 'text-white');
            document.getElementById('lecturerTab').classList.remove('bg-gray-100', 'text-gray-600');
            document.getElementById('studentTab').classList.remove('bg-amber-600', 'text-white');
            document.getElementById('studentTab').classList.add('bg-gray-100', 'text-gray-600');
        }

        // Register Student
async function registerStudent() {
    const fullName = document.getElementById('studentFullName').value;
    const dob = document.getElementById('studentDob').value;
    const nationality = document.getElementById('studentNationality').value;
    const phone = document.getElementById('studentPhone').value;
    const email = document.getElementById('studentEmail').value;
    const degree = document.getElementById('studentDegree').value;
    const university = document.getElementById('studentUniversity').value;
    const yearGraduated = document.getElementById('studentYearGraduated').value;
    const program = document.getElementById('studentProgram').value;
    const password = document.getElementById('studentPassword').value;
    const confirmPassword = document.getElementById('studentConfirmPassword').value;

    // Validation
    if (!fullName || !dob || !nationality || !phone || !email || !degree || !university || !yearGraduated || !program || !password || !confirmPassword) {
        alert('Please fill in all required fields');
        return;
    }

    if (password !== confirmPassword) {
        alert('Passwords do not match');
        return;
    }

    if (password.length < 6) {
        alert('Password must be at least 6 characters');
        return;
    }

    try {
        // Generate student ID
        const studentId = Utils.generateStudentId();

        // 1. Create Supabase Auth user
        const authResult = await Auth.signUp(email, password, 'student', {
            full_name: fullName
        });

        if (!authResult.success) {
            throw new Error(authResult.error);
        }

        // 2. Create student record in database
        const studentData = {
            student_id: studentId,
            full_name: fullName,
            date_of_birth: dob,
            nationality: nationality,
            phone_number: phone,
            email: email,
            bachelor_degree: degree,
            university_attended: university,
            year_graduated: parseInt(yearGraduated),
            program_id: parseInt(program),
            semester_id: 1 // Always start at Semester 1
        };

        const dbResult = await DB.students.create(studentData);

        if (!dbResult.success) {
            throw new Error('Failed to create student record');
        }

        // Get program name for display
        const programSelect = document.getElementById('studentProgram');
        const programName = programSelect.options[programSelect.selectedIndex].text;

        // Show success modal
        document.getElementById('successMessage').innerHTML = 
            `Your registration is complete!<br><br>
            <strong>Student ID:</strong> ${studentId}<br>
            <strong>Program:</strong> ${programName}<br>
            <strong>Starting Semester:</strong> Semester 1<br><br>
            Please check your email to verify your account.`;
        document.getElementById('successModal').classList.remove('hidden');
        document.getElementById('successModal').classList.add('flex');

    } catch (error) {
        console.error('Registration error:', error);
        alert('Registration failed: ' + error.message);
    }
}

        // Register Lecturer
        function registerLecturer() {
            const fullName = document.getElementById('lecturerFullName').value;
            const dob = document.getElementById('lecturerDob').value;
            const gender = document.getElementById('lecturerGender').value;
            const phone = document.getElementById('lecturerPhone').value;
            const email = document.getElementById('lecturerEmail').value;
            const rank = document.getElementById('lecturerRank').value;
            const password = document.getElementById('lecturerPassword').value;
            const confirmPassword = document.getElementById('lecturerConfirmPassword').value;

            // Validation
            if (!fullName || !dob || !gender || !phone || !email || !rank || !password || !confirmPassword) {
                alert('Please fill in all required fields');
                return;
            }

            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }

            // Generate lecturer ID (in real app, this would be done by backend)
            const lecturerId = 'LEC' + Math.floor(Math.random() * 10000);

            // In a real application, you would send this data to the backend
            const lecturerData = {
                lecturer_id: lecturerId,
                full_name: fullName,
                date_of_birth: dob,
                gender: gender,
                phone_number: phone,
                email: email,
                academic_rank: rank,
                password: password
            };

            console.log('Lecturer Registration Data:', lecturerData);

            // Show success modal
            document.getElementById('successMessage').innerHTML = 
                `Your registration is complete!<br><br>
                <strong>Lecturer ID:</strong> ${lecturerId}<br>
                <strong>Academic Rank:</strong> ${rank}<br><br>
                Please save your Lecturer ID for login.<br>
                Course assignments will be made by the administration.`;
            document.getElementById('successModal').classList.remove('hidden');
            document.getElementById('successModal').classList.add('flex');
        }

        // Close modal
function closeModal() {
    document.getElementById('successModal').classList.add('hidden');
    document.getElementById('successModal').classList.remove('flex');
    // Redirect to login page
    window.location.href = 'login.html';
}
    </script>
</body>
</html>